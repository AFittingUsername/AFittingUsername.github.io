<!DOCTYPE html>
<html>
<head>
  <title>Message Board</title>
  <style>
    table {
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid black;
      padding: 8px;
    }
  </style>
</head>
<body>
  <h1>Message Board</h1>
  <form id="messageForm">
    <label for="nameInput">Your Name</label><br>
    <input type="text" id="nameInput"><br><br>
    <label for="messageInput">Enter your message</label><br>
    <textarea id="messageInput"></textarea><br><br>
    <label for="customDateTimeInput">Custom Date and Time (Optional):</label><br>
    <input type="text" id="customDateTimeInput" placeholder="dd/mm/yyyy --:--"><br><br>
    <button type="submit">Post</button>
  </form>

  <h2>Filter Messages</h2>
  <label for="nameFilterInput">Filter by Name:</label>
  <input type="text" id="nameFilterInput"><br><br>
  <button type="button" id="filterButton">Filter</button>

  <h2>All Messages</h2>
  <table id="messageTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Date and Time</th>
        <th>Message</th>
      </tr>
    </thead>
    <tbody id="messageBody">
    </tbody>
  </table>

  <script>
    var allMessages = [];

    // Function to display messages
    function displayMessages(messages) {
      var tableBody = document.getElementById("messageBody");
      tableBody.innerHTML = "";

      messages.forEach(function(message) {
        var row = document.createElement("tr");
        var nameCell = document.createElement("td");
        nameCell.textContent = message.name;
        row.appendChild(nameCell);

        var timestampCell = document.createElement("td");
        timestampCell.textContent = message.timestamp;
        row.appendChild(timestampCell);

        var messageCell = document.createElement("td");
        messageCell.textContent = message.message;
        row.appendChild(messageCell);

        tableBody.appendChild(row);
      });
    }

    // Function to save messages to local storage
    function saveMessages() {
      localStorage.setItem("messages", JSON.stringify(allMessages));
    }

    // Function to load messages from local storage
    function loadMessages() {
      var savedMessages = localStorage.getItem("messages");
      if (savedMessages) {
        allMessages = JSON.parse(savedMessages);
        displayMessages(allMessages);
      }
    }

    // Function to handle form submission
    document.getElementById("messageForm").addEventListener("submit", function(event) {
      event.preventDefault();

      var name = trimString(document.getElementById("nameInput").value);
      var message = document.getElementById("messageInput").value;
      var customDateTime = document.getElementById("customDateTimeInput").value.trim();

      var timestamp;
      if (customDateTime) {
        var dateTimeParts = customDateTime.split(" ");
        var dateParts = dateTimeParts[0].split("/");
        var timeParts = dateTimeParts[1].split(":");
        timestamp = new Date(dateParts[2], dateParts[1] - 1, dateParts[0], timeParts[0], timeParts[1]).toLocaleString();
      } else {
        timestamp = new Date().toLocaleString();
      }

      var newMessage = {
        name: name,
        timestamp: timestamp,
        message: message
      };

      allMessages.push(newMessage);
      displayMessages(allMessages);
      saveMessages();

      document.getElementById("nameInput").value = "";
      document.getElementById("messageInput").value = "";
      document.getElementById("customDateTimeInput").value = "";
    });

    // Function to handle filter button click
    document.getElementById("filterButton").addEventListener("click", function() {
      var nameFilterValue = trimString(document.getElementById("nameFilterInput").value).toLowerCase();

      var filteredMessages = allMessages.filter(function(message) {
        var name = trimString(message.name).toLowerCase();
        return name.includes(nameFilterValue);
      });

      displayMessages(filteredMessages);
    });

    // Function to remove leading and trailing whitespace
    function trimString(str) {
      return str.replace(/^\s+|\s+$/g, "");
    }

    // Load messages from local storage on page load
    loadMessages();
  </script>
</body>
</html>
